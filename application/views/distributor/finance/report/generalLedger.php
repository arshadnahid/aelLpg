<?phpif (isset($_POST['start_date'])):    $account = $this->input->post('accountHead');    $from_date = date('d-m-Y', strtotime($this->input->post('start_date')));    $to_date = date('d-m-Y', strtotime($this->input->post('end_date')));else:    $account = $account;endif;?><div class="main-content">    <div class="main-content-inner">        <div class="breadcrumbs ace-save-state  noPrint" id="breadcrumbs">            <ul class="breadcrumb">                <li>                    <i class="ace-icon fa fa-home home-icon"></i>                    <a href="<?php echo site_url('DistributorDashboard/1'); ?>">Finance</a>                </li>                <li class="active">General Ledger Report</li>            </ul>            <ul class="breadcrumb pull-right">                <li class="active">                    <i class="ace-icon fa fa-list"></i>                    <a href="<?php echo site_url('DistributorDashboard/1'); ?>">List</a>                </li>            </ul>        </div>        <br>        <div class="page-content">            <div class="row  noPrint">                <div class="col-md-12">                    <form id="publicForm" action=""  method="post" class="form-horizontal">                        <div class="col-sm-12">                            <div class="table-header">                                General Report                            </div>                            <br>                            <div style="background-color: grey!important;">                                <div class="col-md-4">                                    <div class="form-group">                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1"> Account Head</label>                                        <div class="col-sm-9">                                            <select  name="accountHead" class="chosen-select form-control" id="form-field-select-3" data-placeholder="Search by Account Head"  onchange="check_pretty_cash(this.value)">                                                <option value="" disabled selected></option>                                                <?php                                                foreach ($accountHeadList as $key => $head) {                                                    ?>                                                    <optgroup label="<?php echo $head['parentName']; ?>">                                                        <?php                                                        foreach ($head['Accountledger'] as $eachLedger) :                                                            ?>                                                            <option <?php                                                    if (!empty($account) && $account == $eachLedger->chartId) {                                                        echo "selected";                                                    }                                                            ?> paytoAccountCode="<?php echo $eachLedger->code; ?>" paytoAccountName="<?php echo $eachLedger->title; ?>" value="<?php echo $eachLedger->chartId; ?>"><?php echo $eachLedger->title . " ( " . $eachLedger->code . " ) "; ?></option>                                                            <?php endforeach; ?>                                                    </optgroup>                                                    <?php                                                }                                                ?>                                            </select>                                        </div>                                    </div>                                </div>                                <div class="col-md-3">                                    <div class="form-group">                                        <label class="col-sm-4 control-label no-padding-right" for="form-field-1"> From Date</label>                                        <div class="col-sm-8">                                            <input type="text"class="date-picker" id="start_date" name="start_date" value="<?php                                                if (!empty($from_date)) {                                                    echo $from_date;                                                } else {                                                    echo date('d-m-Y');                                                }                                                ?>" data-date-format='dd-mm-yyyy' placeholder="Start Date: dd-mm-yyyy"/>                                        </div>                                    </div>                                </div>                                <div class="col-md-3">                                    <div class="form-group">                                        <label class="col-sm-4 control-label no-padding-right" for="form-field-1"> To Date</label>                                        <div class="col-sm-8">                                            <input type="text" class="date-picker" id="end_date" name="end_date" value="<?php                                                   if (!empty($to_date)):                                                       echo $to_date;                                                   else:                                                       echo date('d-m-Y');                                                   endif;                                                ?>" data-date-format='dd-mm-yyyy' placeholder="End Date: dd-mm-yyyy"/>                                        </div>                                    </div>                                </div>                                <div class="col-md-2">                                    <div class="form-group">                                        <div class="col-sm-6">                                            <button type="submit" class="btn btn-success btn-sm">                                                <span class="ace-icon fa fa-search icon-on-right bigger-110"></span>                                                Search                                            </button>                                        </div>                                        <div class="col-sm-6">                                            <button type="button" class="btn btn-info btn-sm"  onclick="window.print();" style="cursor:pointer;">                                                <i class="ace-icon fa fa-print  align-top bigger-125 icon-on-right"></i>                                                Print                                            </button>                                        </div>                                    </div>                                </div>                            </div>                        </div>                        <div class="clearfix"></div>                    </form>                </div>            </div><!-- /.col -->            <?php            if (isset($_POST['start_date'])):                $from_date = date('Y-m-d', strtotime($this->input->post('start_date')));                $to_date = date('Y-m-d', strtotime($this->input->post('end_date')));                $account = $this->input->post('accountHead');                unset($_SESSION["account"]);                unset($_SESSION["start_date"]);                unset($_SESSION["end_date"]);                $_SESSION["account"] = $account;                $_SESSION["start_date"] = $from_date;                $_SESSION["end_date"] = $to_date;                $dist_id = $this->dist_id;                $total_pvsdebit = '';                $total_pvscredit = '';                $total_debit = '';                $total_credit = '';                $total_balance = '';                ?>                <div class="row">                    <div class="col-xs-12">                        <div class="table-header">                            General Ledger  <span style="color:greenyellow;">From <?php echo $from_date; ?> To <?php echo $to_date; ?></span>                        </div>                        <table class="table table-responsive">                            <tr>                                <td style="text-align:center;">                                    <h3><?php echo $companyInfo->companyName; ?>.</h3>                                    <span><?php echo $companyInfo->address; ?></span><br>                                    <strong>Phone : </strong><?php echo $companyInfo->phone; ?><br>                                    <strong>Email : </strong><?php echo $companyInfo->email; ?><br>                                    <strong>Website : </strong><?php echo $companyInfo->website; ?><br>                                    <strong><?php echo $pageTitle; ?></strong>                                </td>                            </tr>                        </table>                        <table class="table table-bordered">                            <thead>                                <tr>                                    <td nowrap align="center"><strong>Date</strong></td>                                    <td align="center"><strong>Voucher No.</strong></td>                                    <td align="center"><strong>Type</strong></td>                                    <td align="center"><strong>Voucher By</strong></td>                                    <td align="center"><strong>Memo</strong></td>                                    <td align="center"><strong>Debit (In BDT.)</strong></td>                                    <td align="center"><strong>Credit (In BDT.)</strong></td>                                    <td align="center"><strong>Balance (In BDT.)</strong></td>                                </tr>                            </thead>                            <tbody>                                <!-- PVS Balance -->                                <?php                                // Opening Balance                                $total_opendebit = $this->Finane_Model->opening_balance_dr($dist_id, $account);                                $total_opencredit = $this->Finane_Model->opening_balance_cr($dist_id, $account);                                $this->db->select('SUM(debit) AS totalDebit,SUM(credit) as totalCredit');                                $this->db->from('generalledger');                                $this->db->where('dist_id', $dist_id);                                $this->db->where('account', $account);                                $this->db->where('date <', $from_date);                                $query_pvs = $this->db->get()->row();                                $total_pvsdebit += $query_pvs->totalDebit;                                $total_pvscredit += $query_pvs->totalCredit;                                $dr_pvsbal = $total_pvsdebit + $total_opendebit;                                $cr_pvsbal = $total_pvscredit + $total_opencredit;                                $total_pvsbalance = $dr_pvsbal - $cr_pvsbal;                                ?>                                <tr>                                    <td colspan="5" align="right"><strong>Opening Balance (In BDT.)</strong></td>                                    <td align="right"><strong> <?php //echo number_format((float) abs($total_pvsdebit), 2, '.', ',');                                                                                      ?></strong></td>                                    <td align="right"><strong> <?php //echo number_format((float) abs($total_pvscredit), 2, '.', ',');                                                                                     ?></strong></td>                                    <td align="right"><strong><?php echo number_format((float) abs($total_pvsbalance), 2, '.', ','); ?>&nbsp;                                            <?php                                            if ($dr_pvsbal >= $cr_pvsbal): echo 'Dr.';                                            elseif ($dr_pvsbal < $cr_pvsbal): echo 'Cr.';                                            endif;                                            ?></strong>                                    </td>                                </tr>                                <!-- /PVS Balance -->                                <!-- Search Balance -->                                <?php                                $this->db->select("supplier.sup_id,customer.customer_id,generals.miscellaneous,customer.customerName,customer.customerID,supplier.supName,form.form_id,supplier.supID,form.name,generals.voucher_no,generalledger.debit,generalledger.credit,generalledger.date,generalledger.generals_id,generalledger.memo");                                $this->db->from('generalledger');                                $this->db->join('generals', 'generals.generals_id=generalledger.generals_id', 'left');                                $this->db->join('form', 'form.form_id=generals.form_id', 'left');                                $this->db->join('customer', 'customer.customer_id=generals.customer_id', 'left');                                $this->db->join('supplier', 'supplier.sup_id=generals.supplier_id', 'left');                                $this->db->where('generalledger.dist_id', $dist_id);                                $this->db->where('generalledger.account', $account);                                $this->db->where('generalledger.date >=', $from_date);                                $this->db->where('generalledger.date <=', $to_date);                                $this->db->order_by('generalledger.date', 'ASC');                                $query = $this->db->get()->result_array();                                foreach ($query as $row):                                    ?>                                    <tr>                                        <td nowrap><?php echo date('M d, Y', strtotime($row['date'])); ?></td>                                        <td>                                            <?php                                            if ($row['form_id'] == 14) {                                                ?>                                                <a href="<?php echo site_url('viewMoneryReceiptSup/' . $row['voucher_no']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 2) {                                                ?>                                                <a href="<?php echo site_url('paymentVoucherView/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 3) {                                                ?>                                                <a href="<?php echo site_url('receiveVoucherView/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 7) {                                                ?>                                                <?php echo $row['voucher_no']; ?>                                            <?php } elseif ($row['form_id'] == 1) {                                                ?>                                                <a href="<?php echo site_url('journalVoucherView/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 5) {                                                ?>                                                <a  title="View Sales Voucher"  href="<?php echo site_url('salesInvoice_view/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                                <?php                                            } elseif ($row['form_id'] == 11) {                                                ?>                                                <a title="View Purchases Voucher" href="<?php echo site_url('viewPurchases/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                                <?php                                            } else {                                                echo $row['voucher_no'];                                            }                                            ?>                                        </td>                                        <td><?php echo $row['name']; ?></td>                                        <?php if (!empty($row['customerName'])): ?>                                            <td><a href="<?php echo site_url('customerDashboard/' . $row['customer_id']); ?>"><?php echo $row['customerID'] . ' [ ' . $row['customerName'] . ' ] ' ?></a></td>                                        <?php elseif ($row['supName']): ?>                                            <td><a href="<?php echo site_url('supplierDashboard/' . $row['sup_id']); ?>"><?php echo $row['supID'] . ' [ ' . $row['supName'] . ' ] ' ?></a></td>                                        <?php else: ?>                                            <td><?php echo $row['miscellaneous'] ?></td>                                        <?php endif; ?>                                        <td><?php echo $row['memo']; ?></td>                                        <td align="right"><?php                                echo number_format((float) abs($row['debit']), 2, '.', ',');                                $total_debit += $row['debit'];                                        ?></td>                                        <td align="right"><?php                                    echo number_format((float) abs($row['credit']), 2, '.', ',');                                    $total_credit += $row['credit'];                                        ?></td>                                        <td align="right">                                            <?php                                            $dr_bal = $total_debit;                                            $cr_bal = $total_credit;                                            $total_balance = $dr_bal - $cr_bal;                                            $lastBalance = $total_balance + $total_pvsbalance;                                            ?>                                            <?php echo number_format((float) abs($total_balance + $total_pvsbalance), 2, '.', ','); ?>&nbsp;                                            <?php                                            if ($lastBalance >= 1) {                                                echo 'Dr.';                                            } else {                                                echo 'Cr.';                                            }                                            ?>                                        </td>                                    </tr>                                <?php endforeach; ?>                                <!-- /Search Balance -->                                <?php                                if ($total_pvsbalance >= 1) {                                    $total_debit+=$total_pvsbalance;                                } else {                                    $total_credit+=$total_pvsbalance;                                }                                ?>                            </tbody>                            <tfoot>                                <tr>                                    <td colspan="5" align="right"><strong>Ending Balance (In BDT.)</strong></td>                                    <td align="right"><strong><?php echo number_format((float) abs($total_debit), 2, '.', ','); ?>&nbsp;Dr.</strong></td>                                    <td align="right"><strong> <?php echo number_format((float) abs($total_credit), 2, '.', ','); ?>&nbsp;Cr.</strong></td>                                    <td align="right"><strong><?php echo number_format((float) abs($total_balance + $total_pvsbalance), 2, '.', ','); ?>&nbsp;<?php                            if ($lastBalance >= 1) {                                echo 'Dr.';                            } else {                                echo 'Cr.';                            }                                ?></strong>                                    </td>                                </tr>                            </tfoot>                        </table>                    </div>                </div>                <?php            else:                $account = $account;                ?>                <div class="row">                    <div class="col-xs-12">                        <div class="table-header">                            General Ledger                        </div>                        <table class="table table-responsive">                            <tr>                                <td style="text-align:center;">                                    <h3><?php echo $companyInfo->companyName; ?>.</h3>                                    <span><?php echo $companyInfo->address; ?></span><br>                                    <strong>Phone : </strong><?php echo $companyInfo->phone; ?><br>                                    <strong>Email : </strong><?php echo $companyInfo->email; ?><br>                                    <strong>Website : </strong><?php echo $companyInfo->website; ?><br>                                    <strong><?php echo $pageTitle; ?></strong>                                </td>                            </tr>                        </table>                        <table class="table table-bordered">                            <thead>                                <tr>                                    <td nowrap align="center"><strong>Date</strong></td>                                    <td align="center"><strong>Voucher No.</strong></td>                                    <td align="center"><strong>Type</strong></td>                                    <td align="center"><strong>Voucher By</strong></td>                                    <td align="center"><strong>Memo</strong></td>                                    <td align="center"><strong>Debit (In BDT.)</strong></td>                                    <td align="center"><strong>Credit (In BDT.)</strong></td>                                    <td align="center"><strong>Balance (In BDT.)</strong></td>                                </tr>                            </thead>                            <tbody>                                <!-- PVS Balance -->                                <?php                                // Opening Balance                                $total_opendebit = $this->Finane_Model->opening_balance_dr($dist_id, $account);                                $total_opencredit = $this->Finane_Model->opening_balance_cr($dist_id, $account);                                $this->db->select('SUM(debit) AS totalDebit,SUM(credit) as totalCredit');                                $this->db->from('generalledger');                                $this->db->where('generalledger.dist_id', $dist_id);                                $this->db->where('generalledger.account', $account);                                $this->db->where('generalledger.date <', date('Y-m-d'));                                $query_pvs = $this->db->get()->row();                                $total_pvsdebit += $query_pvs->totalDebit;                                $total_pvscredit += $query_pvs->totalCredit;                                $dr_pvsbal = $total_pvsdebit + $total_opendebit;                                $cr_pvsbal = $total_pvscredit + $total_opencredit;                                $total_pvsbalance = $dr_pvsbal - $cr_pvsbal;                                ?>                                <tr>                                    <td colspan="5" align="right"><strong>Opening Balance (In BDT.)</strong></td>                                    <td align="right"><strong> <?php //echo number_format((float) abs($total_pvsdebit), 2, '.', ',');                                                                                      ?></strong></td>                                    <td align="right"><strong> <?php //echo number_format((float) abs($total_pvscredit), 2, '.', ',');                                                                                     ?></strong></td>                                    <td align="right"><strong>                                            <?php echo number_format((float) abs($total_pvsbalance), 2, '.', ','); ?>&nbsp;                                            <?php                                            if ($dr_pvsbal >= $cr_pvsbal): echo 'Dr.';                                            elseif ($dr_pvsbal < $cr_pvsbal): echo 'Cr.';                                            endif;                                            ?>                                        </strong>                                    </td>                                </tr>                                <!-- /PVS Balance -->                                <!-- Search Balance -->                                <?php                                $this->db->select("supplier.sup_id,customer.customer_id,generals.miscellaneous,customer.customerName,customer.customerID,supplier.supName,form.form_id,supplier.supID,form.name,generals.voucher_no,generalledger.debit,generalledger.credit,generalledger.date,generalledger.generals_id,generalledger.memo");                                $this->db->from('generalledger');                                $this->db->join('generals', 'generals.generals_id=generalledger.generals_id', 'left');                                $this->db->join('form', 'form.form_id=generals.form_id', 'left');                                $this->db->join('customer', 'customer.customer_id=generals.customer_id', 'left');                                $this->db->join('supplier', 'supplier.sup_id=generals.supplier_id', 'left');                                // $this->db->join('generals','generals.generals_id=generalledger.generals_id','right');                                $this->db->where('generalledger.dist_id', $dist_id);                                $this->db->where('generalledger.account', $account);                                $this->db->where('generalledger.date >=', date('Y-m' . '-01'));                                $this->db->where('generalledger.date <=', date('Y-m-d'));                                $this->db->where('generalledger.date', 'ASC');                                $query = $this->db->get()->result_array();                                foreach ($query as $row):                                    ?>                                    <tr>                                        <td nowrap><?php echo date('M d, Y', strtotime($row['date'])); ?></td>                                        <td>                                            <?php                                            if ($row['form_id'] == 14) {                                                ?>                                                <a href="<?php echo site_url('viewMoneryReceiptSup/' . $row['voucher_no']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 2) {                                                ?>                                                <a href="<?php echo site_url('paymentVoucherView/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 3) {                                                ?>                                                <a href="<?php echo site_url('receiveVoucherView/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 7) {                                                ?>                                                <?php echo $row['voucher_no']; ?>                                            <?php } elseif ($row['form_id'] == 1) {                                                ?>                                                <a href="<?php echo site_url('journalVoucherView/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                            <?php } elseif ($row['form_id'] == 5) {                                                ?>                                                <a  title="View Sales Voucher"  href="<?php echo site_url('salesInvoice_view/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                                <?php                                            } elseif ($row['form_id'] == 11) {                                                ?>                                                <a title="View Purchases Voucher" href="<?php echo site_url('viewPurchases/' . $row['generals_id']); ?>"><?php echo $row['voucher_no']; ?></a>                                                <?php                                            } else {                                                echo $row['voucher_no'];                                            }                                            ?>                                        </td>                                        <td><?php echo $row['name']; ?></td>                                        <?php if (!empty($row['customerName'])): ?>                                            <td><a href="<?php echo site_url('customerDashboard/' . $row['customer_id']); ?>"><?php echo $row['customerID'] . ' [ ' . $row['customerName'] . ' ] ' ?></a></td>                                        <?php elseif ($row['supName']): ?>                                            <td><a href="<?php echo site_url('supplierDashboard/' . $row['sup_id']); ?>"><?php echo $row['supID'] . ' [ ' . $row['supName'] . ' ] ' ?></a></td>                                        <?php else: ?>                                            <td><?php echo $row['miscellaneous'] ?></td>                                        <?php endif; ?>                                        <td><?php echo $row['memo']; ?></td>                                        <td align="right"><?php                                echo number_format((float) abs($row['debit']), 2, '.', ',');                                $total_debit += $row['debit'];                                        ?></td>                                        <td align="right"><?php                                    echo number_format((float) abs($row['credit']), 2, '.', ',');                                    $total_credit += $row['credit'];                                        ?></td>                                        <td align="right">                                            <?php                                            $dr_bal = $total_debit;                                            $cr_bal = $total_credit;                                            $total_balance = $dr_bal - $cr_bal;                                            $lastBalance = $total_balance + $total_pvsbalance;                                            ?>                                            <?php echo number_format((float) abs($total_balance + $total_pvsbalance), 2, '.', ','); ?>&nbsp;                                            <?php                                            if ($lastBalance >= 1) {                                                echo 'Dr.';                                            } else {                                                echo 'Cr.';                                            }                                            ?>                                        </td>                                    </tr>                                <?php endforeach; ?>                                <!-- /Search Balance -->                                <?php                                if ($total_pvsbalance >= 1) {                                    $total_debit+=$total_pvsbalance;                                } else {                                    $total_credit+=$total_pvsbalance;                                }                                ?>                            </tbody>                            <tfoot>                                <tr>                                    <td colspan="5" align="right"><strong>Ending Balance (In BDT.)</strong></td>                                    <td align="right"><strong><?php echo number_format((float) abs($total_debit), 2, '.', ','); ?>&nbsp;Dr.</strong></td>                                    <td align="right"><strong> <?php echo number_format((float) abs($total_credit), 2, '.', ','); ?>&nbsp;Cr.</strong></td>                                    <td align="right"><strong><?php echo number_format((float) abs($total_balance + $total_pvsbalance), 2, '.', ','); ?>&nbsp;<?php                            if ($lastBalance >= 1) {                                echo 'Dr.';                            } else {                                echo 'Cr.';                            }                                ?></strong>                                    </td>                                </tr>                            </tfoot>                        </table>                    </div>                </div>            <?php endif; ?>        </div><!-- /.row -->    </div><!-- /.page-content --></div>